from jose.jwt import decode
from pprint import pprint
OAUTH_GRANT_TYPE_CLIENT_CREDENTIALS_SCOPES = " ".join(
    ["https://platform.konfio.mx/core/client-admin"]
)

def decode_jwt(token: str) -> dict:
    return decode(
        token, key=None, options={"verify_signature": False, "verify_aud": False, "verify_exp": False}
    )

access = "eyJraWQiOiJoN0VQbW15WEJvWVwvNTN3STJXUDBiRDdzZEI2VE5jXC9IOThxVkZKcXpZejA9IiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJtaDdtNDVsb3BraDMwaXBxYnRmbXZnMHJkIiwidG9rZW5fdXNlIjoiYWNjZXNzIiwic2NvcGUiOiJodHRwczpcL1wvcGxhdGZvcm0ua29uZmlvLm14XC9jb3JlXC9jbGllbnQtYWRtaW4iLCJhdXRoX3RpbWUiOjE2NDMzMjU4ODQsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC51cy13ZXN0LTIuYW1hem9uYXdzLmNvbVwvdXMtd2VzdC0yX1BxcklWZU5OZCIsImV4cCI6MTY0MzMyNzY4NCwiaWF0IjoxNjQzMzI1ODg0LCJ2ZXJzaW9uIjoyLCJqdGkiOiI3ODBlNWFiZS1iZDA4LTQzOTMtYjFjNy1lYmYwZWQ3Mjg2MGUiLCJjbGllbnRfaWQiOiJtaDdtNDVsb3BraDMwaXBxYnRmbXZnMHJkIn0.yZLs9mPOkufwwrAaIaHCKXDOrOTAbUdwq2U2gWjDvo9FF2LJYqaH_vV5V5riY6Cvt9bCllAmMO7WE-_Q3lXLF2pyml6ioHvmd8gFOdSTzOlRa7Wci8wII9AN8nIl2_pShNoIKFpwBs6I5QDvGos52At7hmSwGoZQ4iNAeZrLWzeXw7QPEs497CTiv1XBjAB_L71Wsq0QrzyGf2EbiIJ1PG3dr29tsgM0NBpWICyWk7NRLQh6nmzZdM732m9pUde70mMb_puaureBNEqJA4LVfqZy1DW3qJww6mJN6-5JjFURyn3ZHASm5tLNkApgA3NeEyRMGA9NNkn0aYhxp7aplA"
#access = "eyJraWQiOiJoN0VQbW15WEJvWVwvNTN3STJXUDBiRDdzZEI2VE5jXC9IOThxVkZKcXpZejA9IiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiI1ODEwMjgwYy03ZDBiLTQyYmYtOThlOS1kMDk0MjU0ZDgyYzQiLCJkZXZpY2Vfa2V5IjoidXMtd2VzdC0yX2UwOTExNWZkLWUzNzMtNDcxOC1iOGRiLTBiNzI4NmY5ZDAxMSIsImNvZ25pdG86Z3JvdXBzIjpbInVzZXIiXSwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLnVzLXdlc3QtMi5hbWF6b25hd3MuY29tXC91cy13ZXN0LTJfUHFySVZlTk5kIiwiY2xpZW50X2lkIjoiMnYzdGtvOTl1M2VpaWQ0aGllODB1ZHZjbGsiLCJvcmlnaW5fanRpIjoiZTViY2YyMGQtMGE0Zi00YmQxLWEyOWItNzJjYmE5NDQ5NjI2IiwiZXZlbnRfaWQiOiJmOTdmOWIzNC00M2YwLTRkOTctYTQxNy0yMWZiOWZlOGVlMzMiLCJ0b2tlbl91c2UiOiJhY2Nlc3MiLCJzY29wZSI6ImF3cy5jb2duaXRvLnNpZ25pbi51c2VyLmFkbWluIiwiYXV0aF90aW1lIjoxNjQzMzI2MDUyLCJleHAiOjE2NDMzMjc4NTIsImlhdCI6MTY0MzMyNjA1MiwianRpIjoiYzdhNDJkMzQtZmIyNy00NGJmLTk2YjUtNzkyNjQzZDRmZDVmIiwidXNlcm5hbWUiOiI1ODEwMjgwYy03ZDBiLTQyYmYtOThlOS1kMDk0MjU0ZDgyYzQifQ.tpNFx8sP2S_ytI5dpn2_FqmUbkTxWREoYV_ozXU5zdv5pDgs73-U7M3v_rel4_Hz-U8nwGp_2MxMSE9uOUnap_5ZvuUw08Oqz05yt5Ge8iJTBDIfxmkR_enqJF5DAjSBwBRAwaGLxYDwHoaPxkX5vnMT0fi01dnvAkPNQpnr02I87gJGiUKQmsVj9lPmms5HskRiUvs3vybAeW0WRM6n0alVJXt8Ck6pJO_zGFmNX5fQdnluCUI5i5eZmIjk_GVSqzJBxU7h-EoXXqctr4y4tSkQA84jy6nqTrScbbr-DiQlGdl4kxhNTeIPPk3c_VlX5alY6cBV-lS2Hyqvt48Zww"
ac = decode_jwt(access)
if OAUTH_GRANT_TYPE_CLIENT_CREDENTIALS_SCOPES != ac["scope"]:
    print("token no tiene oauth scope")
else:
    pprint(ac)